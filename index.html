<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Transaksi Numpang Ngopi.crb</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body class="bg-gray-50 font-sans text-gray-900">

  <!-- HEADER -->
  <header class="bg-[#3b2f2f] text-white p-4 text-center">
    <h1 class="text-2xl font-bold">Transaksi Numpang Ngopi.crb</h1>
    <marquee class="text-sm text-gray-200">#Kopinyabenerankopi.</marquee>
  </header>

  <!-- MENU -->
  <main class="p-4 space-y-6 pb-40">
    
    <!-- Menu Premium -->
    <section>
      <h2 class="text-lg font-semibold mb-2">â˜• Menu Premium</h2>
      <div class="grid grid-cols-2 gap-3">
        <button onclick="addToCart('Kopi Gula Aren',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Kopi Gula Aren<br><span class="text-sm">Rp10.000</span></button>
        <button onclick="addToCart('Kopi Latte',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Kopi Latte<br><span class="text-sm">Rp10.000</span></button>
        <button onclick="addToCart('Kopi Cappuccino',12000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Kopi Cappuccino<br><span class="text-sm">Rp12.000</span></button>
        <button onclick="addToCart('Kopi Stevia',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Kopi Stevia<br><span class="text-sm">Rp10.000</span></button>
      </div>
    </section>

    <!-- Menu Keliling -->
    <section>
      <h2 class="text-lg font-semibold mb-2">ðŸš² Menu Keliling</h2>
      <div class="grid grid-cols-2 gap-3">
        <button onclick="addToCart('Kopi Aren',8000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Kopi Aren<br><span class="text-sm">Rp8.000</span></button>
        <button onclick="addToCart('Kopi Latte',8000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Kopi Latte<br><span class="text-sm">Rp8.000</span></button>
      </div>
    </section>

    <!-- Non Coffee Premium -->
    <section>
      <h2 class="text-lg font-semibold mb-2">ðŸ¥¤ Non Coffee Premium</h2>
      <div class="grid grid-cols-2 gap-3">
        <button onclick="addToCart('Taro Latte',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Taro Latte*<br><span class="text-sm">Rp10.000</span></button>
        <button onclick="addToCart('Red Velvet Latte',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Red Velvet Latte*<br><span class="text-sm">Rp10.000</span></button>
        <button onclick="addToCart('Chocolate',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Chocolate*<br><span class="text-sm">Rp10.000</span></button>
        <button onclick="addToCart('Brownsugar Milk',10000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Brownsugar Milk<br><span class="text-sm">Rp10.000</span></button>
      </div>
    </section>

    <!-- Non Coffee Keliling -->
    <section>
      <h2 class="text-lg font-semibold mb-2">ðŸ¥› Non Coffee Keliling</h2>
      <div class="grid grid-cols-2 gap-3">
        <button onclick="addToCart('Taro',5000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Taro<br><span class="text-sm">Rp5.000</span></button>
        <button onclick="addToCart('Red Velvet',5000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Red Velvet<br><span class="text-sm">Rp5.000</span></button>
        <button onclick="addToCart('Coklat',5000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Coklat<br><span class="text-sm">Rp5.000</span></button>
        <button onclick="addToCart('Gula Ren Milk',5000)" class="p-4 bg-white rounded-xl shadow hover:bg-gray-100">Gula Ren Milk<br><span class="text-sm">Rp5.000</span></button>
      </div>
    </section>

  </main>

  <!-- KERANJANG -->
  <aside class="fixed bottom-0 left-0 w-full bg-white shadow-xl rounded-t-2xl p-4">
    <h2 class="font-bold text-lg mb-2">ðŸ›’ Keranjang</h2>
    <ul id="cart" class="text-sm space-y-1 max-h-32 overflow-y-auto"></ul>
    <p class="mt-2 font-semibold">Total: Rp <span id="total">0</span></p>
    <div class="grid grid-cols-2 gap-2 mt-3">
      <button onclick="saveTransaction()" class="bg-green-700 text-white py-2 rounded-xl">Simpan</button>
      <button onclick="printReceipt()" class="bg-gray-700 text-white py-2 rounded-xl">Cetak</button>
      <button onclick="sendWhatsApp()" class="bg-[#25D366] text-white py-2 rounded-xl">Kirim WA</button>
      <button onclick="clearCart()" class="bg-red-700 text-white py-2 rounded-xl">Hapus</button>
    </div>
  </aside>

  <script>
    // Firebase config
    const firebaseConfig = {
      databaseURL: "https://sistem-kasir-numpang-ngopi-default-rtdb.asia-southeast1.firebasedatabase.app/"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let cart = [];
    function addToCart(item, price) {
      cart.push({item, price});
      renderCart();
    }

    function renderCart() {
      const cartList = document.getElementById("cart");
      const totalEl = document.getElementById("total");
      cartList.innerHTML = "";
      let total = 0;
      cart.forEach((c, i) => {
        total += c.price;
        const li = document.createElement("li");
        li.textContent = `${c.item} - Rp${c.price.toLocaleString()}`;
        cartList.appendChild(li);
      });
      totalEl.textContent = total.toLocaleString();
    }

    function clearCart() {
      cart = [];
      renderCart();
    }

    function saveTransaction() {
      const time = new Date().toISOString();
      db.ref("transaksi/" + time).set({
        items: cart,
        total: cart.reduce((a,b)=>a+b.price,0),
        waktu: time
      });
      alert("Transaksi disimpan âœ…");
      clearCart();
    }

    function printReceipt() {
      let struk = "=== Numpang Ngopi.crb ===\n";
      cart.forEach(c => { struk += `${c.item} - Rp${c.price}\n`; });
      struk += "Total: Rp" + cart.reduce((a,b)=>a+b.price,0);
      const w = window.open();
      w.document.write("<pre>" + struk + "</pre>");
      w.print();
    }

    function sendWhatsApp() {
      const total = cart.reduce((a,b)=>a+b.price,0);
      let pesan = "Transaksi Numpang Ngopi:\n";
      cart.forEach(c => pesan += `${c.item} - Rp${c.price}\n`);
      pesan += `Total: Rp${total}`;
      const nomor = prompt("Masukkan nomor WA (contoh: 089xxxx):");
      if(nomor){
        window.open(`https://wa.me/62${nomor.slice(1)}?text=${encodeURIComponent(pesan)}`);
      }
    }
  </script>

</body>
</html>
