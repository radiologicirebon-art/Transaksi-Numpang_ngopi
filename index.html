<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Numpang Ngopi.crb ‚Äî Kasir</title>
  <style>
    body { font-family: 'Poppins', Arial, sans-serif; margin: 0; padding: 0; background: #f8f9fa; }
    header { background: #1d899b; color: #fff; padding: 15px; text-align: center; }
    header h1 { margin: 0; font-size: 22px; }
    header p { margin: 5px 0 0; font-size: 14px; }

    main { padding: 15px; max-width: 1000px; margin: auto; }

    .card { background: #fff; padding: 15px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .card h2 { margin-top: 0; font-size: 18px; border-left: 4px solid #1d899b; padding-left: 8px; }

    .menu-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; }
    .menu-btn { background: #1d899b; color: #fff; border: none; padding: 12px; border-radius: 8px; font-size: 14px; cursor: pointer; transition: 0.2s; }
    .menu-btn:hover { background: #166c79; }

    .btn-row { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
    button.action { flex: 1; padding: 12px; font-size: 14px; border-radius: 8px; cursor: pointer; }
    .save { background: #28a745; color: #fff; border: none; }
    .clear { background: #dc3545; color: #fff; border: none; }
    .print { background: #ffc107; color: #000; border: none; }

    input { padding: 8px; border: 1px solid #ccc; border-radius: 6px; width: 100%; margin: 5px 0; }

    .cart-item { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px dashed #ddd; font-size: 14px; }
    .summary p { margin: 5px 0; font-size: 14px; }
  </style>
</head>
<body>
  <header>
    <h1>Numpang Ngopi.crb ‚Äî Kasir</h1>
    <p>Sistem kasir modern untuk kedai kopi</p>
  </header>

  <main>
    <!-- Menu -->
    <div class="card">
      <h2>Menu Kopi</h2>
      <div id="menuKopi" class="menu-grid"></div>
    </div>

    <div class="card">
      <h2>Menu Non Kopi</h2>
      <div id="menuNonKopi" class="menu-grid"></div>
    </div>

    <!-- Keranjang -->
    <div class="card">
      <h2>Keranjang</h2>
      <div id="cart"></div>
      <div class="summary">
        <p><strong>Total:</strong> Rp <span id="total">0</span></p>
        <p><strong>Pembayar:</strong></p>
        <input type="number" id="paidAmount" placeholder="Jumlah bayar">
        <p><strong>Kembalian:</strong> Rp <span id="change">0</span></p>
        <p><strong>Jumlah Item:</strong> <span id="itemCount">0</span></p>
      </div>
      <div class="btn-row">
        <button class="action save" onclick="saveTransaction()">üíæ Simpan</button>
        <button class="action clear" onclick="clearCart()">üóë Bersihkan</button>
        <button class="action print" onclick="printReceipt()">üñ® Cetak Struk</button>
      </div>
    </div>
  </main>

  <script>
    // ---------------------------
    // Data menu default
    // ---------------------------
    let defaultMenu = {
      kopi: [
        { name: "Americano", price: 6000 },
        { name: "Kopi Susu Gula Aren", price: 8000 },
        { name: "Kopi Latte", price: 8000 },
        { name: "Kopi Susu Taro", price: 10000 },
        { name: "Kopi Susu Almond", price: 10000 },
        { name: "Kopi Mochachino", price: 10000 }
      ],
      nonKopi: [
        { name: "Taro", price: 5000 },
        { name: "Coklat", price: 5000 },
        { name: "Tarro Latte", price: 8000 },
        { name: "Chocolate", price: 8000 }
      ]
    };

    let cart = [];
    let total = 0;

    const menuKopiDiv = document.getElementById("menuKopi");
    const menuNonKopiDiv = document.getElementById("menuNonKopi");
    const cartDiv = document.getElementById("cart");
    const totalSpan = document.getElementById("total");
    const itemCountSpan = document.getElementById("itemCount");
    const changeSpan = document.getElementById("change");
    const paidAmount = document.getElementById("paidAmount");

    // ---------------------------
    // Render Menu
    // ---------------------------
    function renderMenu() {
      menuKopiDiv.innerHTML = "";
      menuNonKopiDiv.innerHTML = "";
      defaultMenu.kopi.forEach((item, index) => {
        let btn = document.createElement("button");
        btn.className = "menu-btn";
        btn.textContent = `${item.name} (Rp${item.price})`;
        btn.onclick = () => addToCart(item);
        menuKopiDiv.appendChild(btn);
      });
      defaultMenu.nonKopi.forEach((item, index) => {
        let btn = document.createElement("button");
        btn.className = "menu-btn";
        btn.textContent = `${item.name} (Rp${item.price})`;
        btn.onclick = () => addToCart(item);
        menuNonKopiDiv.appendChild(btn);
      });
    }

    // ---------------------------
    // Keranjang
    // ---------------------------
    function addToCart(item) {
      let found = cart.find(c => c.name === item.name);
      if (found) {
        found.qty++;
      } else {
        cart.push({ ...item, qty: 1 });
      }
      refreshCart();
    }

    function refreshCart() {
      cartDiv.innerHTML = "";
      total = 0;
      let itemCount = 0;
      cart.forEach((item, i) => {
        let line = document.createElement("div");
        line.className = "cart-item";
        line.innerHTML = `
          ${item.name} x${item.qty} - Rp${item.price * item.qty}
          <button onclick="removeItem(${i})">‚ùå</button>`;
        cartDiv.appendChild(line);
        total += item.price * item.qty;
        itemCount += item.qty;
      });
      totalSpan.textContent = total;
      itemCountSpan.textContent = itemCount;
      let change = (parseInt(paidAmount.value) || 0) - total;
      changeSpan.textContent = change >= 0 ? change : 0;
    }

    function removeItem(i) {
      cart.splice(i, 1);
      refreshCart();
    }

    function clearCart() {
      cart = [];
      refreshCart();
    }

    function saveTransaction() {
      alert("‚úÖ Transaksi berhasil disimpan.\nTotal: Rp " + total);
      clearCart();
      paidAmount.value = "";
    }

    // ---------------------------
    // Cetak Struk
    // ---------------------------
    function printReceipt() {
      let w = window.open('', '', 'width=400,height=600');
      let receipt = `
        <html>
          <head>
            <title>Struk Numpang Ngopi.crb</title>
            <style>
              body { font-family: monospace; padding: 10px; }
              h2 { text-align: center; margin-bottom: 10px; }
              hr { border: none; border-top: 1px dashed #000; margin: 10px 0; }
              .right { text-align: right; }
            </style>
          </head>
          <body>
            <h2>Numpang Ngopi.crb</h2>
            <div>${cart.map(item => `${item.name} x${item.qty} = Rp${item.price*item.qty}`).join("<br>")}</div>
            <hr>
            <p>Total: Rp ${total}</p>
            <p>Bayar: Rp ${paidAmount.value || 0}</p>
            <p>Kembali: Rp ${(paidAmount.value || 0) - total}</p>
            <hr>
            <p style="text-align:center;">Terima Kasih üôè</p>
          </body>
        </html>
      `;
      w.document.write(receipt);
      w.document.close();
      w.print();
    }

    // Init
    renderMenu();
    paidAmount.oninput = refreshCart;
  </script>
</body>
</html>
